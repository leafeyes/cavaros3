{% extends "front/nav_afterLogin.html" %}

{% block content %}

    <div class="container white" id="main-content" >
    <br>
    <div role="tabpanel">

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" ><a href="/profiles/{{ USERID }}/" style="margin:5px; font-size: 18px; background-color: #ECECEC;">Profile</a></li>
        <li role="presentation"><a href="/projectManagerDashboard/" style="margin:5px; font-size: 18px; background-color: #ECECEC;">Owned Projects</a></li>
        <li role="presentation" class="active"><a aria-controls="home" role="tab" data-toggle="tab" href="assignedTask" >Assigned Tasks</a></li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id=#assignedTask">

			<h3 id="thankHead" align="left">
                <span class=" glyphicon glyphicon-tasks" aria-hidden="true" style="font-size: 20px;"></span>
                <b>{{ USERNAME }}'s Assigned Tasks</b>
            </h3>



			<br>
			<div class="panel panel-default">
				<div class="panel-body">
					<div class="row">
						<div class="col-sm-8">
							<div class="btn-toolbar" role="toolbar">

								<button type="button" class="btn btn-default btn-md">
                                   <span class="glyphicon glyphicon-list"></span> see all tasks
								</button>


							</div>
						</div>
						<div class="col-sm-4">
							<div class="input-group">
								<input class="form-control" placeholder="search" type="text">
								<span class="input-group-btn">
									<button class="btn btn-default" id="buttonClick" type="button">
										Go!
									</button> </span>
							</div>
						</div>
					</div>
				</div>
			</div>

			<ul class="list-group col-xs-9">
				<li class="list-group-item"  id="headMemberProject" style="background: #F4F4F4;">
					All Task in Hand
				</li>

			</ul>
			<div class="row">
                {% for projectAll in  PROJECTALL %}
                    {% for  project in ASSIGNEDPROJECT %}
                        {% if project.project_id == projectAll.id   %}
                            {% for section in SECTIONALL %}
                            {% for sectionAll in projectAll.sections_set.all %}
                                {% if section.id == sectionAll.id %}
                                  {% for task in TASKALL %}
                                    {% for taskAll in sectionAll.tasks_set.all %}
                                         {% if task.id == taskAll.id %}

                                              <div class="col-xs-9">
                                                    <ul class="list-group" >

                                                        <li class="list-group-item" style="background: #F4F4F4; ">

                                                            <div class="row">
                                                                <div class="col-xs-6" >

                                                                    <h4><a id="toggle" class="toggleArrow" data-toggle="collapse" data-parent="#accordion" href="#{{ task.id }}detail " style="font-size: 10px; color: #C0A16Bc">
                                                                        <span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span>
                                                                    </a>
                                                                        &nbsp;&nbsp;

                                                                        Task :

                                                                        <a data-toggle="collapse" data-parent="#accordion"href="#{{ task.id }}detail " >  {{ task.tasks_name }}</a>
                                                                        &nbsp;&nbsp;&nbsp;&nbsp;
                                                                    </h4>

                                                                </div>
                                                                <div class="col-xs-6" >
                                                                    <a href=""><h4 align="right" > 80% </h4></a>
                                                                </div>
                                                            </div>

                                                            <div class="progress">
                                                                <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 80%;" align="center">

                                                                </div>
                                                            </div>

                                                        </li>
                                                        <li class="list-group-item" id="taskList-left" style="background: #;">
                                                            Project: {{ projectAll.project_name }} / Section: {{ section.sections_name }}
                                                            <hr  style="margin-top: 10px;">
                                                            <div class="row" align="left" style="margin-top: -15px;">

                                                                <div class="col-md-4" >
                                                                    Due date: {{ task.end_date }}

                                                                </div>
                                                                <div class="col-md-8" >
                                                                    <div class="row">
                                                                        <div class="col-xs-4" align="left" style="width: 160px;">
                                                                            Remaining time:
                                                                        </div>
                                                                        <div class="col-xs-6" align="left">
                                                                            <div id="countbox1" style="font-size: 20px; margin-top: 2px;"></div>
                                                                        </div>
                                                                    </div>

                                                                </div>
                                                            </div>


                                                        </li>
                                                        <div id="{{ task.id }}detail" class="panel-collapse  collapse" style="margin-top: -5px;">
                                                            <ul class="list-group" id="taskList-left">
                                                                <li class="list-group-item" style="background: #F4F4F4; " id="taskList-left">
                                                                    Description
                                                                </li>

                                                                <li class="list-group-item" id="taskList-left">
                                                                    {{ task.description }}                                                                    <br>
                                                                </li>

                                                                <li class="list-group-item" style="background: #F4F4F4;   ">
                                                                    Task check list
                                                                </li>

                                                                <li class="list-group-item" style="background: #; ">

                                                                    <div class="panel panel-default" align="left" style="margin-top: 10px; padding: 10px;">
                                                                        <div class="row" style="background-color: #;  border-radius: 6px;" align="left">
                                                                            <div class="col-md-10" style="background-color: ; margin-top: 0px;" align="left">
                                                                                <input type="checkbox" class="checkbox large" >

                                                                                1. Register at BitBucket.org (http://www.bitbucket.org). Please using your MU email ( @student.mahidol.ac.th or @student.mahidol.edu ) in registration because you will get Unlimited Plan automatically (Unlimited members per team).
                                                                            </div>
                                                                            <div class="col-md-2" align="center" style="background-color: #; margin-top:10px; font-size: 18px;">

                                                                                <div class="panel panel-default"  style="background-color: #F0F0F0">
                                                                                    End date
                                                                                </div>
                                                                                <div class="panel panel-default" style="margin-top: -25px;">
                                                                                    01/01/14
                                                                                </div>

                                                                            </div>







                                                                        </div>




                                                                        <hr>
                                                                        Task files :
                                                                        {% for file in FILES %}
                                                                            <button class="btn btn-default" id="buttonClick" type="button" data-toggle="modal" data-target="#{{file.id}}" style="font-family: 'arial'; background-color: #E6E6E6">
                                                                                {{ file.filename}}
                                                                            </button>

                                                                        {% endfor %}
                                                                        <hr>
                                                                        <!-- Upload form. Note enctype attribute! -->
                                                                        <form method="post" enctype="multipart/form-data" action="/uploadFile/">
                                                                            {% csrf_token %}
                                                                            <div class="row">
                                                                                <div class="col-md-6" ><input class="btn btn-default btn-lg" type="file" name="sentFile" /></div>
                                                                                <div class="col-md-2" >  <input class="btn btn-default btn-lg" type="submit" name="submit" value="Upload" /></div>
                                                                            </div>
                                                                        </form>
                                                                    </div>



                                                                </li>
                                                                {% for file in FILES %}
                                                                <!-- Modal -->
                                                                <div class="modal fade" id="{{file.id}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"align="left">
                                                                    <div class="modal-dialog modal-lg">
                                                                        <div class="modal-content">
                                                                            <div class="modal-header">
                                                                                <button type="button" class="close" data-dismiss="modal">
                                                                                    <span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
                                                                                </button>
                                                                                <h2 class="modal-title" id="myModalLabel">{{file.filename}}</h2>
                                                                            </div>
                                                                            <div class="modal-body" >
                                                                                <div class="row">
                                                                                    <div class="col-md-6">

                                                                                        <div class="panel panel-default" align="center" id="taskList-left">
                                                                                            <div class="panel-heading">
                                                                                                Current version
                                                                                            </div>

                                                                                            <div class="panel-body	" align="center">

                                                                                                <img src="/site_media/img/file.jpg" width="200" class="img-responsive">

                                                                                                {{ file.filename }}
                                                                                                <br>
                                                                                                <small> version 1.0  | date modified: {{ file.create_date }}</small>

                                                                                            </div>

                                                                                            <div class="panel-footer">
                                                                                                <button type="button" class="btn btn-default btn-sm">
                                                                                                    <span class="glyphicon glyphicon-save"></span>
                                                                                                </button>

                                                                                                <button type="button" class="btn btn-default btn-sm">
                                                                                                    <span class="glyphicon glyphicon-link"></span>
                                                                                                </button>

                                                                                                <button type="button" class="btn btn-default btn-sm">
                                                                                                    <span class="glyphicon glyphicon-pencil"></span>
                                                                                                </button>
                                                                                                <button type="button" class="btn btn-default btn-sm">
                                                                                                    <span class="glyphicon glyphicon-trash"></span>
                                                                                                </button>
                                                                                            </div>

                                                                                        </div>
                                                                                        <div class="panel panel-default" style="background-color: #f4f4f4;" >

                                                                                            <ul class="list-group" id="taskList-left">
                                                                                                {% for com in file.comment.all  %}
                                                                                                <li class="list-group-item" style="background: #fff;">
                                                                                                    <div class="row">
                                                                                                        <div class="col-md-3">
                                                                                                            {{ com.username }}
                                                                                                        </div>
                                                                                                        <div class="col-xs-9">
                                                                                                            {{ com.comment }}
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <small>{{ com.create_date }}</small>
                                                                                                </li>
                                                                                                {% endfor %}


                                                                                            </ul>

                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="col-md-6">
                                                                                        <div class="panel panel-default" id="taskList-left">
                                                                                            <div class="panel-heading">
                                                                                                Historical version
                                                                                            </div>
                                                                                            <div class="list-group">

                                                                                                <a href="#downloadToggle"  data-toggle="collapse" data-parent="#accordion"  class="list-group-item">
                                                                                                <div class="row">
                                                                                                    <div class="col-xs-10">
                                                                                                        <!-- usecaseNarrative.docx -->
                                                                                                        <br>
                                                                                                        <small> <!-- version 1.0  | date modified: 01/01/14 15:32:10-->
                                                                                                            <br>
                                                                                                            <!-- responsibility: Sirachat</small>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-->
                                                                                                    </div>
                                                                                                    <div class="col-xs-2" >
                                                                                                        <div id="downloadToggle"  align="center" class="panel-collapse collapse">
                                                                                                            <button type="button" class="btn btn-default btn-sm">
                                                                                                                <span class="glyphicon glyphicon-save"></span>
                                                                                                            </button>
                                                                                                            <br>
                                                                                                            <button type="button" class="btn btn-default btn-sm">
                                                                                                                <span class="glyphicon glyphicon-link"></span>
                                                                                                            </button>
                                                                                                            <br>
                                                                                                            <button type="button" class="btn btn-default btn-sm">
                                                                                                                <span class="glyphicon glyphicon-pencil"></span>
                                                                                                            </button>
                                                                                                            <button type="button" class="btn btn-default btn-sm">
                                                                                                                <span class="glyphicon glyphicon-trash"></span>
                                                                                                            </button>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div> </a>

                                                                                            </div>
                                                                                        </div>
                                                                                    </div>

                                                                                </div>

                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                {% endfor %}
                                                            </ul>
                                                        </div>
                                                        <br>

                                                    </ul>
                                                </div>
                                                  {% endif %}
                                  {% endfor %}
                                  {% endfor %}
                                {% endif %}
                            {% endfor %}
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                {% endfor %}
			</div>
		</div>
		<div align="center">
			<nav >
				<ul class="pagination">
					<li>
						<a href="#">&laquo;</a>
					</li>
					<li>
						<a href="#">1</a>
					</li>

					<li>
						<a href="#">&raquo;</a>
					</li>
				</ul>
			</nav>

		</div>
		</div>

		<script>
			$(function() {
				$('#myTab a:last').tab('show');
			});
		</script>
		<script>
			$(function() {
				$("#SectionStartdatepicker").datepicker();
			});
			$(function() {
				$("#SectionEnddatepicker").datepicker();
			});
			$(function() {
				$("#TaskStartdatepicker").datepicker();
			});
			$(function() {
				$("#TaskEnddatepicker").datepicker();
			});
		</script>
		<script type="text/javascript">
			//###################################################################
			// Author: ricocheting.com
			// Version: v3.0
			// Date: 2014-09-05
			// Description: displays the amount of time until the "dateFuture" entered below.

			var CDown = function() {
				this.state = 0;
				// if initialized
				this.counts = [];
				// array holding countdown date objects and id to print to {d:new Date(2013,11,18,18,54,36), id:"countbox1"}
				this.interval = null;
				// setInterval object
			}

			CDown.prototype = {
				init : function() {
					this.state = 1;
					var self = this;
					this.interval = window.setInterval(function() {
						self.tick();
					}, 1000);
				},
				add : function(date, id) {
					this.counts.push({
						d : date,
						id : id
					});
					this.tick();
					if (this.state == 0)
						this.init();
				},
				expire : function(idxs) {
					for (var x in idxs) {
						this.display(this.counts[idxs[x]], "OUT OF DATE");
						this.counts.splice(idxs[x], 1);
					}
				},
				format : function(r) {
					var out = "";
					if (r.d != 0) {
						out += r.d + " " + ((r.d == 1) ? "day" : "days") + " / ";
					}
					if (r.h != 0) {
						out += r.h + " " + ((r.h == 1) ? "hour" : "hrs") + ": ";
					}
					out += r.m + " " + ((r.m == 1) ? "min" : "min") + ": ";
					out += r.s + " " + ((r.s == 1) ? "sec" : "sec") + ": ";

					return out.substr(0, out.length - 2);
				},
				math : function(work) {
					var y = w = d = h = m = s = ms = 0;

					ms = ("" + ((work % 1000) + 1000)).substr(1, 3);
					work = Math.floor(work / 1000);
					//kill the "milliseconds" so just secs

					y = Math.floor(work / 31536000);
					//years (no leapyear support)
					w = Math.floor(work / 604800);
					//weeks
					d = Math.floor(work / 86400);
					//days
					work = work % 86400;

					h = Math.floor(work / 3600);
					//hours
					work = work % 3600;

					m = Math.floor(work / 60);
					//minutes
					work = work % 60;

					s = Math.floor(work);
					//seconds

					return {
						y : y,
						w : w,
						d : d,
						h : h,
						m : m,
						s : s,
						ms : ms
					};
				},
				tick : function() {
					var now = (new Date()).getTime(), expired = [], cnt = 0, amount = 0;

					if (this.counts)
						for (var idx = 0, n = this.counts.length; idx < n; ++idx) {
							cnt = this.counts[idx];
							amount = cnt.d.getTime() - now;
							//calc milliseconds between dates

							// if time is already past
							if (amount < 0) {
								expired.push(idx);
							}
							// date is still good
							else {
								this.display(cnt, this.format(this.math(amount)));
							}
						}

					// deal with any expired
					if (expired.length > 0)
						this.expire(expired);

					// if no active counts, stop updating
					if (this.counts.length == 0)
						window.clearTimeout(this.interval);

				},
				display : function(cnt, msg) {
					document.getElementById(cnt.id).innerHTML = msg;
				}
			};

			window.onload = function() {
				var cdown = new CDown();

				cdown.add(new Date(2010, 10, 10, 15, 43, 30), "countbox1");
			};
		</script>
		<script>
			$(document).click(function() {
				$('a.toggleArrow').text(function(i, oldText) {
					if (oldText == '▼') {
						oldText = '▲';
					} else {
						return '▼';
					}
					return oldText;
				});
			});

			$('input[type="checkbox"].large').checkbox({
				buttonStyle : 'btn-link btn-large',
				checkedClass : 'icon-check',
				uncheckedClass : 'icon-check-empty'
			});

			$('.checkbox').checkbox();
		</script>

    </div>
{% endblock %}